/*++

Licensed under the Apache-2.0 license.

File Name:

    ml_dsa87_tests.rs

Abstract:

    File contains test cases for ML_DSA87 API tests

--*/

#![no_std]
#![no_main]

use caliptra_cfi_lib::CfiCounter;
use caliptra_drivers::{
    Array4x12, Hmac, HmacData, HmacKey, HmacMode, HmacTag, KeyId, KeyReadArgs, KeyUsage,
    KeyWriteArgs, MlDsa87, MlDsa87MsgScalar, MlDsa87PubKey, MlDsa87Result, MlDsa87SignRndScalar,
    MlDsa87Signature, Trng,
};
use caliptra_registers::csrng::CsrngReg;
use caliptra_registers::entropy_src::EntropySrcReg;
use caliptra_registers::hmac::HmacReg;
use caliptra_registers::mldsa::MldsaReg;
use caliptra_registers::soc_ifc::SocIfcReg;
use caliptra_registers::soc_ifc_trng::SocIfcTrngReg;
use caliptra_test_harness::test_suite;

const PUBKEY: [u8; 2592] = [
    251, 202, 217, 224, 179, 133, 165, 63, 79, 52, 212, 239, 6, 145, 130, 220, 45, 173, 142, 113,
    182, 61, 254, 182, 63, 92, 58, 184, 26, 206, 128, 249, 150, 238, 171, 190, 52, 113, 142, 191,
    39, 216, 4, 52, 168, 202, 179, 10, 194, 99, 157, 193, 210, 194, 71, 144, 18, 54, 54, 188, 120,
    162, 209, 234, 103, 155, 208, 98, 79, 123, 21, 75, 247, 74, 17, 226, 112, 140, 96, 21, 117, 33,
    195, 133, 31, 156, 29, 46, 81, 106, 124, 66, 236, 49, 108, 49, 221, 166, 49, 219, 149, 101,
    186, 165, 103, 72, 121, 232, 128, 208, 59, 226, 199, 172, 189, 255, 116, 43, 140, 73, 249, 134,
    77, 240, 38, 23, 178, 38, 41, 56, 237, 254, 135, 47, 19, 236, 232, 86, 49, 221, 126, 135, 102,
    151, 195, 178, 79, 24, 36, 117, 33, 168, 161, 111, 8, 12, 48, 50, 178, 59, 76, 101, 219, 46,
    220, 43, 248, 112, 224, 251, 87, 244, 202, 145, 160, 40, 223, 147, 84, 134, 108, 156, 99, 106,
    190, 172, 217, 252, 82, 175, 176, 209, 86, 119, 78, 187, 102, 149, 217, 62, 7, 146, 82, 246,
    49, 170, 132, 222, 154, 181, 140, 101, 238, 242, 209, 124, 112, 132, 6, 232, 243, 54, 41, 199,
    194, 233, 200, 182, 236, 161, 174, 4, 236, 91, 229, 27, 246, 218, 245, 246, 163, 86, 88, 82,
    43, 214, 54, 162, 81, 119, 164, 252, 236, 237, 169, 1, 76, 108, 89, 187, 70, 191, 79, 40, 187,
    122, 70, 230, 249, 31, 225, 192, 121, 213, 208, 42, 165, 200, 231, 210, 98, 109, 198, 67, 62,
    122, 211, 197, 211, 232, 23, 42, 25, 199, 221, 18, 173, 164, 119, 86, 216, 166, 209, 184, 86,
    38, 51, 70, 101, 175, 226, 133, 153, 45, 66, 167, 215, 227, 252, 147, 207, 121, 191, 192, 126,
    237, 122, 66, 84, 245, 48, 25, 40, 221, 154, 15, 11, 185, 170, 155, 52, 134, 34, 3, 249, 54,
    46, 6, 215, 89, 72, 83, 40, 253, 55, 189, 41, 138, 189, 164, 200, 52, 224, 60, 55, 125, 16,
    191, 74, 59, 102, 14, 208, 83, 169, 237, 121, 149, 222, 177, 56, 157, 254, 226, 220, 140, 251,
    63, 242, 238, 32, 233, 106, 23, 126, 131, 167, 153, 169, 80, 171, 202, 72, 67, 130, 86, 19, 11,
    1, 34, 112, 19, 58, 2, 58, 35, 34, 178, 141, 86, 57, 236, 39, 223, 229, 194, 69, 227, 63, 14,
    7, 209, 32, 147, 235, 244, 102, 229, 99, 51, 104, 218, 89, 95, 245, 19, 152, 93, 123, 134, 214,
    60, 255, 69, 134, 4, 171, 49, 12, 31, 130, 171, 249, 97, 155, 157, 227, 69, 1, 200, 182, 45,
    44, 84, 187, 101, 106, 95, 150, 127, 20, 102, 234, 15, 192, 24, 48, 218, 67, 112, 67, 246, 202,
    145, 243, 55, 102, 0, 238, 30, 16, 192, 218, 30, 70, 183, 155, 74, 36, 100, 46, 116, 30, 232,
    226, 159, 162, 101, 99, 12, 144, 223, 145, 113, 164, 20, 219, 200, 84, 85, 175, 119, 7, 180,
    30, 89, 106, 227, 214, 113, 7, 51, 194, 77, 70, 95, 235, 161, 32, 248, 57, 106, 6, 74, 154, 18,
    183, 71, 217, 64, 178, 201, 235, 205, 231, 187, 47, 20, 123, 15, 20, 69, 45, 199, 254, 56, 67,
    33, 135, 207, 152, 169, 237, 2, 153, 44, 252, 67, 232, 70, 199, 177, 218, 111, 10, 89, 42, 155,
    171, 225, 45, 53, 71, 132, 34, 247, 202, 198, 223, 42, 22, 206, 158, 152, 46, 111, 174, 98, 67,
    159, 131, 12, 207, 71, 233, 45, 221, 78, 154, 245, 139, 116, 98, 0, 208, 118, 68, 3, 122, 111,
    55, 104, 163, 36, 200, 77, 230, 149, 55, 121, 235, 52, 245, 102, 115, 172, 83, 20, 206, 142,
    97, 154, 57, 242, 250, 155, 68, 99, 71, 170, 91, 180, 192, 115, 143, 177, 91, 133, 91, 238,
    173, 72, 164, 80, 121, 139, 68, 121, 165, 111, 32, 219, 134, 48, 92, 121, 190, 243, 71, 183,
    44, 195, 24, 239, 52, 88, 255, 231, 104, 55, 37, 52, 168, 216, 74, 103, 66, 89, 90, 248, 65,
    134, 29, 54, 34, 46, 220, 228, 236, 83, 85, 168, 173, 126, 231, 239, 116, 98, 222, 232, 243,
    98, 207, 158, 189, 168, 197, 211, 158, 73, 245, 204, 184, 88, 227, 193, 72, 56, 191, 184, 185,
    193, 252, 156, 189, 211, 79, 99, 35, 237, 17, 208, 73, 226, 215, 93, 137, 67, 28, 8, 52, 19,
    72, 35, 82, 27, 48, 206, 218, 75, 152, 205, 139, 135, 74, 100, 146, 167, 181, 158, 61, 159, 92,
    122, 95, 253, 250, 218, 147, 235, 143, 206, 137, 16, 205, 86, 109, 189, 163, 8, 62, 153, 100,
    66, 15, 244, 112, 135, 71, 91, 251, 35, 102, 100, 185, 203, 222, 234, 97, 135, 80, 0, 221, 248,
    253, 109, 64, 25, 97, 205, 92, 33, 227, 247, 193, 55, 128, 203, 177, 63, 126, 75, 9, 134, 167,
    123, 107, 250, 87, 16, 172, 146, 58, 179, 145, 47, 149, 114, 225, 11, 2, 232, 121, 249, 219,
    59, 18, 14, 73, 165, 248, 116, 58, 210, 28, 163, 147, 167, 232, 250, 201, 224, 244, 78, 218,
    70, 73, 76, 94, 233, 205, 204, 13, 103, 173, 123, 195, 169, 130, 42, 185, 180, 59, 156, 149,
    150, 246, 66, 255, 133, 23, 91, 123, 145, 18, 217, 25, 106, 100, 195, 207, 242, 64, 1, 23, 209,
    140, 109, 140, 211, 17, 31, 178, 212, 140, 169, 12, 121, 116, 224, 53, 225, 4, 221, 177, 53,
    127, 28, 193, 213, 46, 35, 113, 34, 50, 197, 16, 73, 65, 212, 114, 89, 137, 7, 216, 82, 0, 49,
    13, 79, 164, 147, 205, 102, 242, 144, 217, 233, 231, 46, 213, 78, 134, 120, 13, 148, 244, 194,
    109, 202, 242, 13, 94, 61, 231, 171, 210, 70, 107, 100, 186, 172, 35, 143, 187, 190, 190, 120,
    12, 181, 242, 171, 125, 183, 39, 22, 110, 186, 142, 218, 141, 19, 163, 138, 214, 162, 143, 16,
    33, 29, 209, 238, 235, 152, 29, 91, 139, 132, 118, 212, 19, 148, 26, 230, 231, 227, 202, 101,
    3, 164, 189, 59, 223, 125, 140, 86, 217, 153, 134, 70, 84, 161, 48, 50, 189, 180, 46, 148, 181,
    83, 213, 53, 247, 106, 208, 249, 91, 114, 9, 189, 15, 134, 219, 74, 89, 228, 125, 57, 159, 70,
    139, 97, 63, 89, 182, 145, 247, 251, 196, 70, 20, 60, 166, 244, 218, 78, 133, 253, 8, 241, 66,
    125, 200, 146, 222, 49, 90, 214, 217, 201, 151, 42, 209, 206, 165, 191, 68, 31, 112, 173, 183,
    113, 243, 193, 115, 3, 77, 152, 132, 85, 58, 243, 138, 211, 35, 49, 51, 131, 194, 105, 171,
    109, 97, 154, 6, 134, 53, 145, 98, 155, 79, 11, 175, 244, 192, 50, 108, 207, 208, 12, 48, 205,
    243, 47, 78, 77, 50, 196, 177, 188, 249, 207, 188, 223, 180, 42, 44, 153, 252, 147, 66, 159,
    140, 127, 56, 148, 124, 168, 32, 67, 56, 106, 19, 194, 202, 51, 51, 46, 214, 208, 34, 191, 165,
    93, 23, 169, 89, 199, 232, 26, 185, 72, 48, 111, 49, 215, 82, 251, 170, 151, 159, 204, 248,
    120, 183, 64, 199, 223, 110, 46, 90, 215, 236, 135, 90, 81, 185, 82, 153, 104, 143, 17, 178,
    107, 27, 123, 184, 19, 126, 47, 135, 138, 172, 199, 109, 240, 225, 3, 215, 141, 185, 78, 105,
    191, 85, 141, 113, 161, 86, 228, 111, 76, 38, 138, 72, 60, 148, 178, 52, 83, 191, 185, 19, 145,
    212, 142, 115, 27, 124, 64, 25, 2, 30, 167, 184, 64, 148, 109, 117, 145, 123, 158, 165, 95, 81,
    68, 39, 6, 27, 248, 161, 154, 139, 133, 93, 18, 50, 7, 29, 231, 239, 135, 251, 93, 117, 54, 38,
    27, 90, 173, 210, 243, 98, 238, 110, 41, 30, 187, 191, 219, 154, 10, 24, 231, 253, 128, 99,
    101, 248, 44, 107, 60, 225, 45, 145, 146, 231, 8, 146, 82, 120, 163, 56, 89, 165, 120, 21, 233,
    15, 24, 147, 145, 238, 236, 209, 28, 187, 168, 103, 92, 99, 111, 197, 157, 12, 236, 53, 126,
    174, 31, 243, 115, 190, 67, 186, 64, 253, 40, 172, 145, 222, 8, 27, 37, 35, 196, 131, 214, 139,
    26, 206, 229, 225, 159, 22, 184, 151, 170, 205, 128, 134, 98, 108, 40, 184, 80, 23, 145, 76,
    164, 182, 221, 61, 180, 207, 9, 187, 115, 242, 169, 46, 143, 223, 176, 36, 128, 109, 87, 15,
    237, 27, 96, 69, 52, 144, 109, 190, 217, 92, 196, 167, 101, 57, 70, 117, 122, 129, 239, 101,
    78, 137, 113, 238, 102, 221, 100, 172, 190, 230, 245, 68, 91, 6, 98, 97, 246, 46, 152, 152,
    224, 45, 36, 38, 154, 222, 77, 1, 215, 62, 197, 55, 83, 83, 202, 172, 52, 5, 37, 181, 209, 137,
    65, 109, 176, 168, 237, 20, 183, 46, 140, 19, 209, 239, 19, 183, 224, 221, 191, 163, 237, 151,
    208, 98, 130, 201, 75, 59, 159, 171, 198, 182, 42, 167, 1, 63, 28, 62, 104, 212, 8, 220, 216,
    199, 120, 127, 25, 160, 198, 186, 119, 84, 73, 29, 11, 195, 31, 239, 232, 116, 110, 212, 76,
    243, 148, 138, 1, 105, 166, 130, 98, 189, 28, 82, 20, 171, 118, 51, 132, 246, 238, 249, 220,
    210, 147, 164, 205, 72, 7, 175, 85, 217, 179, 230, 210, 85, 222, 69, 39, 151, 89, 225, 243,
    124, 210, 247, 204, 56, 171, 59, 149, 112, 29, 14, 11, 178, 214, 192, 43, 132, 151, 57, 62,
    152, 48, 74, 117, 104, 209, 63, 67, 126, 6, 64, 160, 94, 147, 216, 31, 4, 20, 190, 197, 180,
    129, 116, 146, 46, 25, 226, 124, 120, 56, 197, 23, 82, 144, 106, 119, 132, 101, 196, 201, 191,
    164, 15, 141, 212, 167, 169, 43, 151, 22, 190, 202, 152, 101, 82, 173, 171, 141, 253, 1, 113,
    215, 49, 30, 15, 8, 122, 42, 60, 46, 108, 11, 230, 175, 201, 64, 160, 6, 211, 214, 247, 72, 32,
    182, 29, 170, 133, 80, 63, 247, 9, 249, 118, 130, 44, 243, 185, 137, 8, 16, 121, 191, 92, 54,
    231, 184, 0, 223, 41, 178, 253, 12, 232, 48, 235, 39, 104, 191, 77, 189, 7, 122, 76, 189, 207,
    50, 15, 138, 172, 13, 163, 37, 121, 83, 211, 155, 42, 110, 190, 24, 238, 41, 35, 42, 197, 240,
    185, 56, 218, 65, 213, 86, 174, 114, 55, 182, 250, 117, 42, 109, 85, 44, 174, 101, 59, 124,
    170, 81, 166, 210, 142, 236, 105, 179, 13, 243, 8, 166, 64, 162, 209, 57, 237, 144, 142, 188,
    245, 219, 157, 171, 112, 228, 93, 2, 211, 143, 202, 226, 244, 194, 107, 14, 78, 122, 49, 150,
    234, 18, 78, 111, 178, 60, 106, 225, 19, 85, 72, 42, 211, 201, 54, 157, 93, 77, 61, 54, 124,
    218, 158, 31, 112, 30, 141, 199, 176, 135, 245, 84, 240, 215, 26, 219, 1, 21, 196, 97, 153, 19,
    141, 55, 103, 195, 147, 80, 132, 91, 21, 211, 73, 157, 11, 8, 177, 67, 45, 209, 119, 233, 219,
    124, 141, 52, 196, 84, 39, 249, 225, 155, 89, 206, 235, 70, 142, 136, 171, 238, 127, 63, 155,
    106, 121, 33, 1, 240, 8, 100, 222, 147, 77, 115, 82, 140, 244, 222, 5, 143, 55, 167, 71, 79,
    155, 27, 12, 194, 231, 90, 102, 15, 10, 136, 199, 77, 118, 166, 133, 87, 132, 161, 239, 211,
    196, 120, 57, 149, 139, 243, 131, 121, 235, 41, 213, 78, 225, 179, 16, 175, 238, 7, 73, 225,
    74, 250, 184, 105, 188, 21, 228, 190, 20, 163, 120, 14, 194, 195, 9, 34, 35, 98, 149, 233, 79,
    164, 116, 179, 133, 219, 251, 212, 194, 94, 83, 125, 78, 113, 9, 144, 80, 36, 184, 193, 86,
    168, 242, 115, 62, 119, 225, 212, 247, 42, 237, 173, 140, 90, 125, 42, 209, 168, 87, 5, 183,
    92, 1, 221, 167, 56, 73, 209, 44, 45, 18, 177, 121, 59, 204, 85, 25, 230, 206, 101, 161, 199,
    95, 186, 156, 152, 235, 141, 223, 26, 99, 47, 198, 92, 168, 2, 26, 255, 132, 126, 75, 30, 168,
    88, 12, 84, 157, 59, 106, 166, 127, 77, 82, 149, 49, 226, 171, 188, 95, 13, 255, 58, 191, 244,
    143, 128, 251, 165, 141, 149, 18, 190, 195, 70, 186, 129, 45, 19, 123, 0, 246, 162, 108, 42,
    163, 82, 112, 90, 101, 59, 173, 163, 182, 243, 241, 201, 78, 168, 6, 135, 191, 15, 66, 168, 19,
    150, 10, 37, 173, 88, 188, 72, 219, 182, 164, 163, 173, 238, 120, 154, 199, 176, 242, 19, 149,
    48, 4, 16, 234, 77, 95, 124, 144, 106, 115, 75, 119, 68, 184, 34, 91, 10, 122, 151, 236, 34,
    51, 69, 5, 209, 221, 157, 80, 74, 137, 94, 48, 14, 54, 35, 99, 16, 231, 202, 51, 155, 214, 227,
    128, 10, 173, 129, 98, 59, 62, 235, 203, 22, 198, 84, 95, 123, 109, 126, 7, 169, 173, 13, 240,
    240, 2, 150, 153, 212, 39, 183, 28, 17, 175, 149, 224, 53, 199, 160, 144, 179, 205, 0, 183,
    226, 243, 16, 209, 75, 155, 176, 80, 12, 161, 180, 188, 222, 101, 42, 105, 117, 207, 108, 166,
    240, 96, 10, 27, 101, 160, 89, 156, 5, 43, 137, 58, 32, 168, 160, 11, 82, 81, 89, 34, 254, 75,
    62, 83, 113, 79, 174, 59, 103, 172, 30, 231, 61, 145, 197, 211, 188, 184, 49, 168, 194, 13,
    185, 36, 113, 92, 99, 128, 155, 100, 143, 240, 81, 85, 13, 49, 232, 156, 183, 113, 141, 157,
    164, 34, 170, 148, 102, 48, 245, 128, 252, 234, 95, 218, 245, 174, 124, 71, 253, 127, 135, 191,
    233, 134, 86, 133, 72, 214, 126, 102, 118, 167, 149, 20, 70, 0, 97, 236, 187, 103, 160, 63, 95,
    191, 100, 61, 123, 173, 187, 217, 203, 56, 251, 72, 243, 180, 136, 88, 252, 106, 181, 155, 59,
    159, 101, 114, 1, 201, 74, 30, 229, 188, 6, 202, 195, 105, 242, 133, 101, 215, 135, 119, 98,
    157, 31, 160, 61, 64, 90, 229, 130, 90, 246, 202, 4, 127, 31, 191, 143, 250, 203, 49, 77, 95,
    68, 123, 207, 184, 47, 107, 200, 227, 228, 178, 21, 184, 163, 6, 26, 23, 11, 106, 159, 206, 99,
    201, 83, 58, 188, 54, 57, 181, 146, 137, 36, 139, 104, 79, 21, 147, 77, 105, 82, 20, 144, 12,
    82, 235, 59, 93, 192, 126, 111, 235, 68, 181, 59, 222, 188, 66, 204, 62, 30, 74, 105, 95, 139,
    91, 211, 25, 217, 140, 75, 158, 207, 77, 67, 206, 141, 191, 45, 113, 20, 53, 184, 255, 155,
    202, 94, 68, 205, 24, 1, 53, 108, 0, 7, 194, 245, 124, 15, 49, 24, 211, 156, 12, 96, 143, 196,
    68, 72, 47, 171, 95, 242, 43, 45, 94, 82, 212, 91, 238, 50, 242, 205, 249, 161, 208, 50, 109,
    147,
];

const SIGNATURE: [u8; 4628] = [
    211, 210, 148, 168, 141, 152, 17, 222, 104, 63, 8, 6, 151, 147, 134, 100, 203, 10, 28, 42, 253,
    62, 96, 2, 224, 203, 230, 222, 125, 28, 214, 182, 153, 150, 13, 62, 242, 165, 47, 183, 164, 70,
    226, 64, 139, 61, 219, 229, 163, 172, 163, 231, 93, 220, 209, 156, 11, 251, 185, 238, 14, 187,
    158, 130, 63, 219, 81, 173, 58, 130, 119, 166, 1, 102, 187, 101, 126, 99, 182, 184, 197, 202,
    226, 73, 91, 109, 151, 104, 167, 139, 120, 69, 149, 32, 32, 127, 232, 111, 17, 176, 34, 6, 232,
    133, 88, 166, 96, 95, 233, 204, 16, 174, 61, 115, 51, 65, 131, 46, 238, 36, 243, 183, 92, 29,
    113, 46, 203, 58, 163, 160, 204, 98, 166, 192, 240, 178, 122, 207, 30, 106, 96, 151, 251, 106,
    66, 99, 97, 5, 85, 172, 235, 32, 10, 50, 102, 138, 242, 22, 19, 227, 44, 169, 145, 32, 228,
    107, 15, 70, 83, 245, 162, 233, 121, 49, 17, 168, 160, 52, 171, 250, 83, 23, 195, 158, 210,
    146, 12, 227, 5, 12, 141, 219, 53, 97, 120, 189, 78, 196, 94, 149, 77, 33, 212, 246, 171, 102,
    212, 103, 219, 112, 31, 221, 54, 212, 95, 35, 106, 242, 251, 129, 201, 98, 165, 69, 162, 80,
    23, 212, 208, 234, 213, 215, 30, 105, 186, 241, 69, 35, 82, 222, 250, 121, 94, 212, 205, 28,
    211, 71, 44, 42, 120, 53, 4, 137, 141, 219, 250, 215, 203, 147, 193, 209, 191, 99, 136, 105,
    161, 188, 116, 146, 164, 17, 51, 20, 105, 235, 7, 112, 105, 182, 94, 244, 88, 228, 249, 11,
    174, 87, 73, 73, 105, 156, 133, 35, 72, 143, 45, 95, 120, 98, 79, 45, 37, 194, 52, 108, 252,
    181, 50, 166, 132, 110, 228, 6, 197, 68, 190, 69, 125, 169, 57, 57, 196, 181, 95, 22, 197, 106,
    146, 218, 67, 53, 148, 115, 198, 234, 188, 72, 207, 112, 240, 50, 34, 181, 94, 44, 228, 63,
    189, 80, 205, 124, 148, 96, 243, 100, 55, 171, 132, 241, 186, 95, 99, 62, 227, 79, 113, 254,
    42, 82, 73, 236, 55, 154, 55, 97, 157, 235, 70, 8, 234, 161, 12, 27, 49, 78, 168, 6, 52, 154,
    162, 214, 226, 78, 198, 194, 151, 73, 128, 77, 109, 54, 29, 191, 19, 81, 116, 76, 125, 62, 188,
    225, 21, 48, 65, 43, 76, 93, 47, 19, 169, 63, 79, 29, 229, 158, 182, 194, 138, 239, 75, 234, 8,
    86, 150, 203, 223, 169, 113, 241, 160, 214, 119, 51, 241, 200, 30, 154, 50, 226, 2, 133, 136,
    97, 126, 118, 51, 185, 170, 1, 128, 6, 254, 77, 31, 57, 64, 214, 126, 57, 84, 217, 111, 46,
    181, 145, 205, 56, 243, 208, 58, 177, 14, 128, 92, 209, 110, 37, 140, 182, 244, 230, 103, 146,
    240, 167, 203, 106, 151, 87, 220, 17, 162, 121, 135, 85, 163, 111, 220, 154, 94, 66, 71, 209,
    86, 2, 228, 15, 160, 88, 195, 219, 157, 165, 197, 210, 14, 94, 37, 227, 157, 141, 179, 54, 245,
    200, 147, 243, 184, 39, 248, 73, 191, 74, 188, 18, 164, 94, 99, 132, 108, 221, 151, 76, 233,
    212, 237, 150, 32, 98, 219, 3, 24, 102, 221, 183, 195, 136, 31, 200, 121, 160, 137, 79, 129,
    21, 84, 248, 1, 229, 169, 251, 235, 30, 139, 232, 144, 77, 114, 226, 236, 30, 163, 242, 158,
    226, 47, 220, 178, 70, 136, 192, 251, 115, 24, 210, 73, 25, 233, 122, 253, 172, 126, 21, 4,
    107, 96, 80, 201, 22, 49, 189, 188, 105, 130, 114, 92, 215, 119, 116, 139, 53, 222, 50, 48,
    108, 232, 105, 13, 92, 38, 93, 199, 241, 32, 91, 97, 20, 99, 6, 107, 105, 38, 28, 180, 193,
    108, 72, 14, 114, 180, 61, 0, 49, 8, 143, 173, 95, 46, 25, 97, 241, 115, 63, 231, 145, 128,
    133, 47, 48, 111, 57, 189, 39, 172, 88, 194, 111, 252, 49, 217, 38, 162, 238, 169, 192, 89,
    120, 191, 148, 246, 40, 213, 141, 52, 194, 58, 111, 238, 252, 96, 83, 150, 252, 43, 237, 118,
    118, 185, 37, 105, 144, 134, 191, 248, 44, 237, 225, 38, 72, 37, 76, 209, 73, 58, 89, 132, 214,
    92, 226, 193, 202, 7, 147, 172, 95, 239, 90, 104, 125, 92, 254, 60, 49, 22, 163, 246, 161, 77,
    74, 29, 46, 126, 188, 67, 245, 138, 141, 59, 245, 16, 182, 84, 45, 120, 84, 244, 181, 80, 29,
    23, 17, 203, 133, 248, 249, 106, 130, 72, 254, 33, 154, 167, 227, 99, 214, 30, 202, 253, 234,
    1, 215, 95, 227, 154, 23, 42, 238, 19, 26, 119, 153, 227, 247, 18, 28, 237, 101, 56, 66, 159,
    30, 31, 119, 238, 50, 93, 24, 3, 87, 128, 184, 251, 10, 110, 92, 20, 93, 123, 31, 71, 84, 250,
    230, 55, 139, 203, 29, 217, 218, 57, 240, 254, 199, 146, 32, 230, 14, 71, 215, 84, 126, 162,
    203, 208, 185, 245, 238, 220, 197, 137, 232, 138, 55, 240, 152, 201, 208, 93, 231, 209, 144,
    104, 241, 167, 19, 182, 216, 193, 144, 218, 5, 132, 167, 86, 22, 152, 44, 230, 65, 122, 159,
    18, 175, 163, 205, 217, 248, 121, 179, 80, 118, 26, 43, 157, 122, 167, 211, 157, 230, 28, 154,
    169, 96, 249, 222, 15, 229, 150, 214, 58, 240, 153, 249, 207, 5, 103, 110, 191, 237, 3, 220,
    100, 212, 53, 27, 236, 157, 31, 224, 79, 39, 193, 110, 249, 135, 58, 60, 47, 239, 212, 125,
    215, 196, 62, 250, 196, 23, 110, 3, 249, 91, 220, 5, 223, 26, 175, 158, 158, 1, 48, 68, 146,
    114, 2, 59, 15, 64, 89, 21, 37, 17, 251, 81, 139, 178, 38, 154, 164, 67, 121, 205, 46, 217,
    177, 104, 209, 127, 76, 240, 149, 35, 127, 30, 1, 43, 134, 20, 227, 36, 6, 23, 188, 52, 189,
    66, 202, 239, 201, 248, 5, 51, 246, 11, 24, 38, 31, 18, 70, 196, 217, 75, 229, 189, 38, 121,
    34, 212, 139, 166, 156, 239, 231, 121, 37, 142, 159, 45, 20, 75, 39, 199, 66, 26, 175, 211,
    176, 155, 227, 193, 136, 38, 185, 132, 248, 201, 173, 210, 244, 130, 203, 248, 66, 217, 17, 2,
    152, 65, 97, 96, 69, 16, 237, 37, 134, 21, 114, 232, 101, 41, 143, 142, 158, 17, 120, 54, 117,
    162, 116, 28, 112, 74, 131, 251, 188, 108, 232, 52, 30, 50, 147, 136, 33, 226, 120, 145, 217,
    177, 187, 119, 139, 174, 47, 248, 3, 99, 163, 12, 65, 148, 69, 167, 68, 163, 46, 253, 220, 150,
    40, 124, 96, 179, 108, 155, 44, 52, 222, 233, 113, 128, 172, 2, 223, 208, 230, 245, 110, 65,
    158, 93, 187, 124, 241, 51, 94, 130, 180, 140, 195, 3, 217, 171, 30, 166, 254, 124, 38, 43,
    188, 60, 253, 155, 40, 145, 193, 114, 201, 84, 152, 93, 155, 191, 170, 151, 193, 196, 53, 61,
    5, 217, 68, 144, 246, 92, 235, 198, 116, 126, 59, 26, 146, 165, 0, 39, 63, 151, 219, 43, 90,
    98, 168, 246, 235, 218, 7, 154, 113, 190, 156, 105, 1, 50, 51, 56, 175, 151, 145, 72, 176, 37,
    9, 39, 59, 115, 218, 220, 66, 196, 10, 78, 68, 234, 109, 38, 137, 60, 176, 19, 221, 15, 125,
    227, 198, 210, 45, 165, 1, 127, 37, 177, 53, 111, 181, 211, 102, 207, 221, 115, 155, 206, 83,
    171, 152, 109, 142, 8, 240, 75, 254, 158, 53, 85, 62, 151, 181, 179, 237, 248, 71, 150, 160,
    148, 160, 244, 165, 118, 84, 37, 11, 163, 199, 183, 116, 28, 165, 68, 49, 112, 113, 116, 105,
    23, 95, 173, 144, 230, 162, 54, 71, 114, 138, 71, 148, 80, 93, 113, 85, 93, 202, 25, 111, 92,
    41, 148, 156, 91, 125, 35, 215, 49, 64, 92, 76, 13, 27, 149, 218, 143, 144, 91, 164, 194, 122,
    84, 236, 95, 150, 240, 32, 5, 241, 204, 209, 214, 69, 184, 255, 150, 119, 173, 190, 244, 193,
    235, 42, 214, 18, 40, 86, 185, 140, 48, 248, 73, 67, 178, 102, 31, 97, 88, 156, 108, 67, 244,
    42, 230, 40, 126, 127, 49, 204, 99, 214, 124, 241, 229, 252, 50, 204, 232, 96, 115, 157, 101,
    253, 129, 228, 194, 166, 81, 35, 52, 165, 81, 208, 7, 96, 192, 30, 246, 69, 29, 131, 224, 23,
    129, 235, 123, 200, 229, 54, 172, 239, 57, 111, 12, 19, 253, 125, 134, 149, 94, 123, 88, 98,
    17, 237, 101, 230, 240, 241, 34, 216, 28, 189, 18, 66, 142, 103, 98, 10, 18, 6, 78, 165, 119,
    7, 28, 133, 193, 182, 205, 74, 216, 242, 55, 129, 35, 78, 66, 225, 28, 117, 199, 85, 16, 149,
    198, 117, 36, 128, 244, 95, 233, 16, 158, 213, 79, 110, 90, 34, 217, 53, 242, 215, 222, 129,
    131, 158, 94, 29, 48, 206, 200, 197, 33, 21, 221, 97, 65, 58, 205, 30, 53, 205, 24, 172, 249,
    233, 185, 60, 59, 197, 121, 100, 97, 89, 136, 221, 184, 128, 70, 180, 240, 90, 108, 39, 33, 61,
    112, 63, 78, 221, 227, 155, 106, 250, 120, 210, 162, 211, 178, 9, 219, 0, 56, 136, 102, 246,
    201, 187, 171, 151, 182, 143, 248, 136, 226, 53, 190, 128, 128, 211, 96, 149, 223, 190, 212,
    102, 108, 101, 170, 37, 108, 232, 213, 203, 108, 17, 14, 251, 155, 109, 39, 116, 217, 144, 118,
    193, 42, 183, 26, 159, 15, 82, 7, 165, 64, 156, 61, 126, 154, 179, 167, 53, 144, 255, 241, 173,
    84, 106, 49, 164, 2, 185, 153, 240, 254, 174, 245, 187, 246, 180, 240, 242, 228, 58, 238, 202,
    236, 36, 124, 37, 47, 56, 184, 118, 215, 71, 22, 198, 250, 217, 214, 233, 128, 131, 188, 59, 9,
    71, 0, 188, 120, 150, 106, 246, 196, 28, 64, 28, 155, 108, 138, 234, 210, 116, 198, 190, 70,
    125, 85, 44, 203, 194, 57, 162, 2, 23, 62, 225, 177, 111, 250, 201, 48, 55, 214, 2, 53, 138,
    249, 119, 36, 225, 49, 79, 172, 165, 69, 167, 232, 253, 240, 69, 93, 77, 122, 27, 72, 0, 14,
    150, 133, 74, 108, 122, 38, 119, 112, 241, 190, 87, 234, 136, 33, 215, 104, 68, 238, 131, 248,
    99, 19, 53, 57, 52, 210, 60, 43, 224, 186, 215, 172, 234, 182, 49, 229, 184, 41, 243, 50, 203,
    255, 135, 123, 179, 182, 178, 191, 42, 93, 223, 25, 107, 113, 120, 150, 239, 71, 7, 63, 225,
    127, 85, 114, 235, 9, 36, 44, 159, 101, 212, 130, 81, 211, 198, 161, 34, 221, 138, 52, 236,
    209, 28, 232, 187, 64, 159, 224, 219, 61, 202, 174, 161, 93, 188, 119, 39, 76, 168, 104, 209,
    147, 224, 133, 137, 10, 9, 38, 10, 18, 15, 29, 64, 26, 104, 156, 79, 70, 54, 234, 105, 239,
    107, 208, 69, 23, 58, 130, 178, 173, 106, 215, 49, 209, 172, 122, 131, 103, 31, 62, 139, 247,
    238, 174, 245, 200, 98, 94, 53, 54, 4, 162, 156, 229, 159, 178, 102, 101, 227, 230, 148, 195,
    93, 254, 89, 102, 35, 206, 90, 247, 174, 41, 108, 253, 103, 58, 101, 102, 55, 64, 70, 210, 223,
    229, 4, 204, 254, 81, 255, 44, 169, 78, 207, 163, 62, 11, 12, 3, 159, 122, 95, 248, 155, 13,
    107, 187, 173, 80, 189, 236, 132, 104, 200, 72, 117, 31, 153, 191, 59, 61, 198, 197, 50, 193,
    102, 178, 24, 135, 136, 198, 176, 54, 57, 64, 151, 109, 21, 6, 129, 33, 240, 14, 2, 217, 112,
    112, 146, 201, 90, 200, 69, 178, 51, 235, 192, 25, 221, 233, 72, 184, 128, 37, 228, 32, 233,
    51, 162, 31, 42, 112, 12, 186, 197, 211, 195, 175, 177, 87, 50, 191, 35, 135, 120, 58, 92, 110,
    129, 137, 49, 219, 218, 45, 252, 209, 75, 215, 149, 109, 183, 142, 179, 0, 224, 85, 229, 135,
    216, 164, 225, 144, 215, 9, 209, 37, 84, 29, 235, 106, 155, 190, 71, 119, 98, 200, 103, 17,
    174, 250, 249, 53, 5, 8, 239, 215, 223, 185, 147, 44, 22, 202, 34, 166, 43, 95, 155, 153, 234,
    244, 250, 96, 95, 161, 23, 196, 174, 222, 191, 80, 166, 145, 27, 104, 85, 95, 212, 230, 36,
    238, 233, 90, 5, 197, 134, 170, 113, 121, 208, 242, 65, 72, 227, 93, 61, 127, 224, 231, 70, 33,
    246, 71, 0, 162, 185, 67, 241, 208, 242, 3, 102, 185, 31, 87, 1, 98, 164, 215, 211, 230, 82,
    196, 199, 83, 239, 255, 95, 172, 188, 185, 180, 117, 39, 150, 54, 133, 43, 29, 17, 97, 9, 21,
    171, 122, 88, 3, 129, 121, 190, 147, 110, 217, 47, 232, 136, 92, 111, 199, 61, 202, 244, 232,
    214, 72, 75, 134, 167, 208, 163, 162, 225, 221, 211, 58, 251, 223, 149, 49, 100, 96, 51, 53,
    121, 161, 136, 12, 238, 199, 158, 162, 82, 166, 146, 223, 202, 202, 130, 211, 189, 202, 215,
    31, 166, 168, 196, 135, 96, 223, 102, 98, 121, 243, 95, 237, 103, 225, 117, 60, 100, 210, 229,
    148, 249, 189, 105, 78, 69, 116, 12, 33, 87, 72, 84, 239, 99, 188, 105, 255, 18, 96, 78, 131,
    9, 212, 44, 188, 16, 85, 30, 33, 238, 244, 194, 217, 240, 61, 235, 167, 120, 199, 169, 161, 78,
    13, 151, 178, 251, 50, 160, 155, 207, 62, 60, 204, 41, 254, 102, 233, 65, 85, 89, 195, 202, 78,
    0, 88, 113, 135, 224, 237, 252, 154, 102, 190, 92, 187, 70, 168, 14, 221, 100, 132, 69, 175,
    243, 165, 74, 18, 165, 196, 232, 202, 211, 13, 238, 89, 8, 222, 53, 30, 95, 253, 48, 157, 69,
    229, 34, 117, 165, 232, 133, 46, 182, 140, 207, 27, 183, 133, 28, 244, 38, 181, 212, 75, 179,
    22, 162, 21, 199, 101, 80, 125, 185, 49, 166, 17, 247, 25, 51, 250, 253, 26, 111, 27, 237, 51,
    196, 80, 111, 79, 143, 79, 205, 132, 244, 166, 155, 171, 185, 159, 144, 207, 128, 114, 136,
    128, 28, 115, 70, 186, 110, 194, 228, 54, 177, 51, 0, 212, 145, 216, 165, 86, 242, 35, 31, 255,
    239, 149, 19, 193, 107, 84, 136, 61, 60, 95, 113, 160, 45, 116, 164, 101, 252, 166, 189, 110,
    1, 193, 132, 79, 213, 17, 102, 94, 191, 81, 173, 239, 169, 47, 255, 108, 74, 208, 144, 79, 212,
    205, 106, 193, 139, 69, 62, 152, 112, 3, 11, 23, 239, 187, 160, 193, 1, 110, 80, 224, 159, 39,
    11, 112, 1, 135, 250, 98, 251, 13, 143, 3, 165, 201, 68, 234, 194, 93, 3, 158, 165, 138, 194,
    187, 143, 230, 37, 195, 166, 48, 77, 104, 161, 6, 231, 44, 104, 66, 87, 214, 14, 85, 61, 27,
    86, 184, 156, 127, 19, 203, 217, 249, 222, 122, 29, 43, 3, 17, 169, 133, 209, 175, 244, 188,
    89, 15, 249, 37, 107, 149, 50, 132, 70, 60, 73, 26, 141, 86, 244, 30, 23, 10, 163, 125, 166,
    226, 230, 107, 149, 76, 227, 82, 209, 59, 152, 18, 101, 227, 25, 32, 243, 230, 74, 166, 16, 74,
    148, 151, 81, 201, 237, 81, 158, 181, 153, 242, 13, 162, 126, 248, 152, 18, 42, 91, 193, 214,
    189, 122, 226, 159, 68, 216, 163, 239, 177, 238, 5, 5, 4, 122, 181, 236, 98, 82, 63, 107, 124,
    30, 191, 211, 172, 89, 236, 51, 1, 53, 222, 192, 10, 230, 36, 232, 208, 87, 120, 184, 1, 7, 12,
    228, 122, 236, 93, 94, 164, 250, 166, 132, 31, 1, 56, 188, 168, 229, 11, 131, 172, 54, 147,
    243, 143, 255, 1, 36, 87, 94, 232, 90, 39, 158, 116, 15, 6, 15, 197, 34, 190, 68, 77, 177, 194,
    88, 242, 172, 37, 73, 222, 44, 194, 124, 193, 155, 154, 57, 219, 237, 202, 84, 151, 34, 35,
    188, 195, 10, 106, 188, 191, 102, 193, 213, 145, 0, 147, 174, 194, 89, 142, 206, 58, 110, 119,
    86, 149, 183, 167, 121, 167, 192, 80, 218, 163, 46, 191, 95, 39, 20, 213, 190, 103, 127, 74,
    255, 68, 88, 136, 163, 66, 169, 50, 232, 25, 215, 31, 51, 83, 132, 118, 28, 218, 91, 93, 176,
    205, 123, 188, 123, 242, 251, 115, 228, 125, 191, 84, 65, 22, 199, 218, 199, 146, 168, 112, 60,
    58, 170, 218, 4, 125, 91, 3, 72, 214, 77, 133, 243, 251, 43, 255, 176, 210, 151, 54, 197, 253,
    28, 238, 218, 170, 132, 136, 186, 241, 111, 11, 250, 118, 189, 236, 178, 150, 218, 159, 3, 171,
    162, 172, 185, 43, 55, 225, 200, 244, 119, 44, 173, 222, 87, 210, 77, 233, 105, 65, 63, 241,
    220, 130, 235, 123, 68, 199, 89, 234, 130, 139, 84, 16, 46, 30, 51, 197, 246, 172, 102, 14, 31,
    121, 214, 192, 54, 251, 252, 127, 196, 43, 157, 51, 245, 8, 39, 116, 217, 69, 253, 184, 246,
    240, 58, 223, 153, 155, 139, 179, 74, 124, 158, 225, 234, 166, 112, 203, 174, 128, 88, 160, 6,
    56, 1, 165, 38, 168, 64, 225, 137, 228, 223, 137, 228, 227, 160, 218, 243, 79, 69, 188, 64,
    122, 139, 191, 98, 107, 10, 232, 19, 36, 221, 94, 17, 27, 200, 137, 137, 252, 213, 7, 200, 97,
    46, 188, 4, 169, 193, 131, 129, 239, 179, 144, 118, 57, 113, 220, 70, 177, 106, 214, 225, 182,
    115, 175, 181, 84, 83, 129, 114, 107, 151, 62, 135, 103, 75, 176, 231, 65, 208, 112, 100, 2,
    193, 75, 99, 14, 122, 57, 122, 122, 136, 150, 170, 105, 208, 252, 246, 142, 161, 15, 29, 10,
    71, 3, 9, 99, 41, 23, 68, 58, 118, 190, 208, 151, 59, 149, 84, 26, 40, 211, 176, 63, 0, 159,
    235, 115, 84, 54, 11, 218, 183, 216, 147, 207, 96, 33, 99, 4, 48, 90, 92, 172, 36, 213, 233,
    247, 194, 124, 247, 225, 130, 159, 27, 111, 75, 52, 84, 38, 248, 18, 148, 32, 161, 117, 18, 86,
    131, 129, 161, 202, 51, 211, 103, 147, 215, 229, 230, 34, 187, 185, 93, 37, 53, 179, 202, 106,
    201, 105, 207, 212, 167, 152, 191, 200, 70, 141, 200, 230, 249, 244, 110, 199, 125, 36, 18,
    103, 217, 2, 167, 125, 170, 75, 20, 224, 92, 251, 26, 234, 35, 18, 81, 212, 186, 233, 98, 9,
    181, 64, 67, 28, 176, 15, 79, 242, 202, 244, 111, 248, 36, 122, 231, 2, 98, 216, 4, 226, 149,
    161, 9, 211, 139, 134, 249, 207, 79, 92, 247, 176, 52, 10, 6, 189, 39, 84, 99, 46, 179, 83,
    248, 75, 6, 122, 103, 129, 244, 143, 13, 154, 240, 8, 137, 52, 123, 8, 85, 51, 121, 201, 5, 60,
    6, 63, 113, 40, 31, 218, 47, 222, 201, 140, 58, 149, 243, 186, 131, 128, 27, 183, 173, 93, 190,
    200, 130, 254, 237, 51, 1, 124, 214, 240, 237, 61, 193, 63, 232, 243, 239, 191, 212, 101, 17,
    11, 103, 88, 134, 233, 64, 37, 213, 108, 143, 218, 121, 222, 82, 243, 207, 198, 193, 179, 230,
    164, 250, 40, 105, 206, 38, 45, 132, 45, 59, 226, 74, 112, 49, 36, 171, 82, 62, 2, 186, 195,
    145, 121, 205, 208, 179, 154, 229, 33, 2, 238, 95, 127, 57, 18, 173, 27, 13, 201, 63, 162, 199,
    142, 25, 155, 8, 100, 5, 134, 61, 12, 193, 135, 41, 192, 219, 121, 240, 176, 150, 91, 11, 145,
    142, 113, 75, 160, 220, 177, 141, 68, 39, 66, 72, 139, 99, 79, 7, 50, 51, 82, 31, 91, 72, 2,
    66, 106, 109, 161, 254, 134, 232, 96, 175, 140, 139, 53, 101, 221, 195, 36, 211, 16, 176, 156,
    218, 7, 170, 181, 82, 157, 200, 79, 190, 234, 162, 73, 180, 189, 200, 166, 49, 128, 228, 137,
    222, 19, 81, 45, 160, 102, 128, 139, 51, 56, 82, 105, 57, 159, 6, 166, 94, 222, 35, 188, 57,
    128, 158, 168, 117, 221, 154, 100, 226, 200, 203, 122, 75, 11, 141, 194, 152, 120, 142, 11,
    199, 111, 20, 203, 216, 76, 200, 125, 164, 117, 59, 208, 4, 150, 151, 103, 56, 85, 232, 180,
    61, 162, 23, 137, 143, 176, 79, 251, 184, 240, 175, 185, 78, 221, 175, 171, 5, 60, 128, 66,
    184, 204, 79, 38, 118, 121, 95, 196, 190, 181, 219, 200, 230, 61, 65, 232, 81, 196, 119, 85,
    221, 194, 91, 151, 45, 121, 159, 44, 13, 5, 123, 105, 112, 56, 161, 228, 44, 194, 110, 67, 209,
    231, 255, 69, 172, 165, 199, 105, 87, 100, 27, 177, 54, 255, 9, 223, 224, 31, 211, 231, 191,
    182, 123, 2, 81, 191, 246, 42, 45, 238, 165, 162, 137, 206, 103, 84, 51, 251, 210, 133, 98,
    127, 113, 125, 82, 151, 155, 212, 20, 97, 245, 122, 26, 119, 114, 198, 168, 208, 100, 58, 218,
    60, 148, 70, 69, 184, 81, 76, 242, 193, 17, 210, 107, 193, 166, 243, 46, 132, 21, 76, 66, 223,
    254, 226, 167, 155, 9, 247, 141, 185, 6, 18, 227, 95, 57, 77, 64, 34, 31, 218, 24, 0, 119, 138,
    140, 206, 185, 85, 219, 35, 47, 97, 180, 55, 251, 205, 153, 24, 216, 50, 241, 240, 143, 113,
    94, 237, 40, 17, 23, 148, 88, 178, 251, 127, 213, 99, 232, 195, 149, 104, 127, 145, 149, 39,
    54, 109, 168, 98, 167, 118, 4, 24, 27, 184, 146, 82, 182, 184, 28, 31, 55, 0, 248, 239, 243,
    24, 37, 102, 240, 140, 146, 162, 95, 130, 174, 146, 78, 23, 139, 143, 11, 208, 162, 152, 209,
    209, 34, 73, 106, 176, 210, 167, 62, 15, 7, 153, 182, 146, 79, 207, 222, 125, 115, 189, 104,
    132, 165, 217, 73, 128, 133, 48, 135, 128, 27, 184, 209, 86, 78, 140, 32, 21, 119, 66, 55, 240,
    255, 152, 89, 87, 200, 83, 20, 237, 126, 10, 111, 252, 169, 111, 232, 236, 170, 70, 246, 246,
    237, 226, 93, 194, 184, 150, 49, 132, 217, 40, 169, 38, 54, 5, 190, 131, 53, 10, 176, 235, 51,
    173, 172, 150, 131, 80, 153, 245, 213, 69, 215, 95, 38, 55, 152, 212, 204, 251, 105, 96, 48,
    108, 71, 41, 185, 57, 2, 177, 105, 90, 101, 226, 242, 232, 120, 11, 172, 225, 141, 16, 159, 49,
    135, 231, 41, 223, 102, 131, 101, 50, 39, 42, 245, 225, 244, 117, 188, 108, 55, 99, 182, 92,
    126, 254, 235, 223, 154, 228, 86, 224, 194, 25, 138, 83, 162, 169, 137, 207, 203, 220, 72, 164,
    83, 168, 179, 173, 138, 87, 191, 21, 66, 200, 90, 32, 246, 115, 81, 190, 231, 152, 187, 198,
    21, 62, 33, 215, 134, 5, 1, 157, 66, 244, 50, 118, 98, 194, 177, 254, 238, 65, 103, 110, 242,
    66, 133, 138, 149, 35, 21, 90, 161, 109, 253, 52, 78, 50, 248, 83, 238, 109, 113, 241, 177,
    177, 50, 141, 8, 7, 157, 62, 241, 177, 182, 213, 128, 152, 213, 100, 99, 173, 236, 22, 72, 218,
    37, 243, 140, 115, 39, 27, 74, 48, 14, 9, 75, 59, 62, 77, 227, 23, 139, 45, 44, 122, 96, 186,
    162, 108, 72, 95, 228, 41, 25, 26, 248, 195, 49, 209, 60, 218, 47, 90, 101, 34, 195, 90, 10,
    157, 21, 255, 76, 64, 223, 37, 29, 26, 46, 56, 120, 132, 21, 42, 245, 240, 85, 199, 19, 201,
    85, 193, 219, 221, 215, 223, 84, 246, 95, 245, 5, 75, 224, 171, 164, 25, 224, 150, 9, 216, 217,
    213, 15, 151, 241, 76, 233, 18, 40, 254, 100, 93, 154, 53, 251, 217, 138, 131, 51, 74, 10, 121,
    247, 180, 44, 8, 228, 61, 221, 148, 195, 96, 13, 218, 83, 72, 171, 45, 19, 4, 216, 206, 167,
    199, 5, 151, 63, 26, 213, 246, 170, 247, 140, 152, 237, 72, 148, 250, 153, 140, 67, 46, 66,
    232, 169, 48, 246, 190, 89, 66, 108, 236, 145, 63, 249, 218, 181, 10, 146, 35, 99, 161, 186,
    180, 125, 90, 167, 213, 198, 75, 29, 95, 57, 176, 116, 214, 117, 70, 0, 191, 237, 127, 153,
    134, 185, 97, 90, 225, 93, 237, 204, 247, 238, 213, 66, 28, 219, 91, 198, 120, 173, 144, 14,
    80, 139, 9, 213, 79, 27, 220, 47, 81, 240, 145, 90, 59, 170, 188, 247, 98, 84, 181, 173, 181,
    53, 155, 115, 80, 38, 180, 119, 243, 243, 137, 133, 227, 149, 157, 166, 189, 60, 49, 182, 74,
    147, 205, 106, 173, 150, 227, 134, 140, 130, 79, 2, 162, 192, 213, 192, 70, 137, 99, 137, 213,
    55, 198, 252, 229, 48, 48, 66, 222, 16, 7, 225, 202, 50, 122, 120, 90, 132, 169, 153, 166, 15,
    109, 48, 40, 71, 199, 36, 255, 202, 167, 23, 42, 247, 127, 185, 165, 157, 65, 160, 58, 144, 24,
    166, 128, 85, 244, 93, 79, 20, 14, 91, 83, 178, 79, 245, 120, 148, 23, 242, 208, 76, 160, 141,
    211, 104, 95, 185, 223, 122, 62, 120, 177, 74, 144, 93, 71, 251, 160, 208, 44, 192, 91, 222,
    171, 184, 125, 41, 186, 170, 254, 183, 129, 157, 10, 197, 117, 164, 203, 38, 57, 13, 175, 225,
    135, 210, 76, 231, 139, 53, 198, 74, 107, 109, 61, 235, 58, 158, 163, 118, 35, 20, 97, 222,
    127, 219, 228, 34, 216, 0, 55, 125, 197, 182, 153, 134, 169, 13, 195, 157, 128, 195, 229, 192,
    25, 177, 100, 249, 160, 58, 239, 77, 144, 166, 239, 105, 126, 136, 82, 25, 180, 244, 9, 185,
    133, 210, 67, 20, 165, 35, 179, 188, 130, 100, 132, 77, 12, 105, 73, 76, 246, 40, 152, 80, 83,
    253, 166, 73, 19, 224, 72, 83, 90, 227, 236, 57, 203, 16, 222, 91, 20, 99, 80, 183, 230, 4, 4,
    202, 65, 66, 43, 98, 21, 99, 247, 97, 50, 50, 223, 235, 238, 12, 198, 119, 152, 208, 139, 103,
    43, 98, 56, 233, 60, 161, 164, 1, 92, 129, 89, 124, 44, 177, 62, 130, 96, 38, 113, 17, 83, 160,
    216, 177, 146, 127, 111, 250, 201, 73, 112, 102, 102, 67, 112, 62, 116, 32, 31, 210, 124, 252,
    83, 215, 137, 44, 31, 2, 87, 3, 147, 134, 204, 245, 94, 215, 180, 17, 220, 47, 182, 25, 79,
    104, 255, 76, 81, 213, 23, 130, 99, 32, 232, 81, 190, 157, 93, 65, 225, 203, 197, 196, 98, 89,
    82, 44, 209, 164, 117, 110, 64, 54, 12, 232, 142, 136, 135, 113, 225, 206, 188, 180, 201, 41,
    39, 37, 49, 27, 21, 214, 194, 166, 113, 77, 89, 55, 2, 231, 221, 206, 129, 128, 27, 26, 17,
    249, 95, 85, 65, 55, 225, 214, 188, 164, 39, 35, 249, 236, 0, 0, 0, 115, 0, 0, 0, 0, 8, 0, 0,
    0, 41, 33, 28, 17, 0, 65, 62, 49,
];

fn test_gen_key_pair() {
    let mut trng = unsafe {
        Trng::new(
            CsrngReg::new(),
            EntropySrcReg::new(),
            SocIfcTrngReg::new(),
            &SocIfcReg::new(),
        )
        .unwrap()
    };
    let mut entropy_gen = || trng.generate().map(|a| a.0);

    // This needs to happen in the first test
    CfiCounter::reset(&mut entropy_gen);

    let mut ml_dsa87 = unsafe { MlDsa87::new(MldsaReg::new()) };

    let mut hmac = unsafe { Hmac::new(HmacReg::new()) };
    let key_out_1 = KeyWriteArgs {
        id: KeyId::KeyId0,
        usage: KeyUsage::default().set_ecc_key_gen_seed_en(),
    };

    hmac.hmac(
        &HmacKey::from(&Array4x12::default()),
        &HmacData::from(&[0]),
        &mut trng,
        HmacTag::Key(key_out_1),
        HmacMode::Hmac384,
    )
    .unwrap();

    let seed = KeyReadArgs::new(KeyId::KeyId0);
    let public_key = ml_dsa87.key_pair(&seed, &mut trng).unwrap();

    assert_eq!(public_key, MlDsa87PubKey::from(PUBKEY));
}

fn test_sign() {
    let mut ml_dsa87 = unsafe { MlDsa87::new(MldsaReg::new()) };

    let mut trng = unsafe {
        Trng::new(
            CsrngReg::new(),
            EntropySrcReg::new(),
            SocIfcTrngReg::new(),
            &SocIfcReg::new(),
        )
        .unwrap()
    };

    let msg = MlDsa87MsgScalar::default();
    let sign_rnd = MlDsa87SignRndScalar::default(); // Deterministic signing
    let seed = KeyReadArgs::new(KeyId::KeyId0); // Reuse SEED

    let signature = ml_dsa87
        .sign(
            &seed,
            &MlDsa87PubKey::from(PUBKEY),
            &msg,
            &sign_rnd,
            &mut trng,
        )
        .unwrap();

    assert_eq!(signature, MlDsa87Signature::from(SIGNATURE));
}

fn test_verify() {
    let mut ml_dsa87 = unsafe { MlDsa87::new(MldsaReg::new()) };

    let msg = MlDsa87MsgScalar::default();

    assert_eq!(
        ml_dsa87
            .verify(
                &MlDsa87PubKey::from(PUBKEY),
                &msg,
                &MlDsa87Signature::from(SIGNATURE)
            )
            .unwrap(),
        MlDsa87Result::Success
    );
}

fn test_verify_failure() {
    let mut ml_dsa87 = unsafe { MlDsa87::new(MldsaReg::new()) };

    let msg = MlDsa87MsgScalar::from([0xff; 64]);

    assert_eq!(
        ml_dsa87
            .verify(
                &MlDsa87PubKey::from(PUBKEY),
                &msg,
                &MlDsa87Signature::from(SIGNATURE)
            )
            .unwrap(),
        MlDsa87Result::SigVerifyFailed
    );
}

test_suite! {
    test_gen_key_pair,
    test_sign,
    test_verify,
    test_verify_failure,
}
